//================================================================================
// タイトルシーン
//--------------------------------------------------------------------------------
// TitleScene.cpp
//--------------------------------------------------------------------------------
// 2021 11/29 SatoKen コメント追加
//================================================================================


//********************************************************************************
// インクルード部
//********************************************************************************
#include "TitleScene.h"
#include "fade.h"

#include "input.h"
#include "Sound.h"


//================================================================================
// コンストラクタ
//================================================================================
TitleScene::TitleScene()
	:m_pBg(nullptr),m_pTest(nullptr)
{
	// オブジェクト生成
	m_pBg = new Bg();
	m_pTest = new Test();
}

//================================================================================
// デストラクタ
//================================================================================
TitleScene::~TitleScene()
{
	// オブジェクト解放
	if (m_pBg != nullptr)
	{
		delete m_pBg;
		m_pBg = nullptr;
	}

	if (m_pTest != nullptr)
	{
		delete m_pTest;
		m_pTest = nullptr;
	}
}

//================================================================================
// 初期化
//================================================================================
HRESULT TitleScene::Init()
{
	HRESULT hr = S_OK;

	// 背景初期化
	m_pBg->Init();

	m_pTest->Init();

	// BGM再生
	CSound::Play(BGM_TITLE);

	return hr;
}


//================================================================================
// 終了
//================================================================================
void TitleScene::Uninit()
{
	// 背景終了処理
	m_pBg->Uninit();

	m_pTest->Uninit();

	// BGMストップ
	CSound::Stop(BGM_TITLE);
}


//================================================================================
// 更新
//================================================================================
void TitleScene::Update()
{
	// 背景更新
	m_pBg->Update();

	m_pTest->Update();

	// フェードアウト開始
	if (GetKeyTrigger(VK_RETURN))
	{
		StartFadeOut();
		CSound::Play(SE_DECIDE);
	}

	// フェードイン時に次のシーンへ
	if (GetFade() == FADE_IN)
		SelectScene(SCENE_GAME);

}

//================================================================================
// 描画
//================================================================================
void TitleScene::Draw()
{
	// 背景描画
	m_pBg->Draw();

	m_pTest->Draw();
}
